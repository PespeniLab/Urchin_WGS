# Step 7: Getting pair-wise global Fst values

Folder: WGS/angsd_new/pairwise_fst_cleaned

Method 1:

```bash
./realSFS fst stats ${dir2}/pairwise_fst_cleaned/${pop1}_${pop2}_allsites.fst.idx > ${dir2}/pairwise_fst_cleaned/${pop1}_${pop2}_global.fst
```

-> output: unweighted and weighted (second preferred) global Fst for each pair. However, these are global Fst values prior to filtering based on MAF. So,

Method 2:

```python
import pandas as pd
import matplotlib.pylab as plt
import numpy as np

col_names1=["ID","chr","pos","A", "B"]

df = pd.read_csv('joined_CAP_BOD_allsites',names=col_names1, sep="\s")
df["pos"]=df.pos.astype('int64', copy=False)
#df["A"]=df.A.astype('int64', copy=False)
#df["B"]=df.B.astype('int64', copy=False)

df["fst"]=df["A"]/df["B"]
df.replace([np.inf, -np.inf], np.nan, inplace=True)
df['fst'] = df['fst'].fillna(0)

df = df.drop(["ID","A","B"], 1)

print(df["fst"].mean())
```

Results are in [this](pairwise_global_fst.csv) and  [this](pairwise_global_fst.xlsx) file. My method on the filtered dataset and the realsfs on the original dataset generated pairwise global Fst values that significantly positively correlated (p<0.001, adjusted r-squared = 0.74), and pairwise global Fst values did not correlate with distance between the populations, no matter which method was used, thus there was no isolation by distance in this WGS dataset.

<img src="https://github.com/Cpetak/urchin_adaptation/blob/main/images/realsfs_avefst.png" width="400" />

<img src="https://github.com/Cpetak/urchin_adaptation/blob/main/images/realsfs_dist.png" width="400" />

<img src="https://github.com/Cpetak/urchin_adaptation/blob/main/images/avefst_dist.png" width="400" />

Generated by: https://colab.research.google.com/drive/1yV1KPBpzY4SdfjBD3tNhRzrwl1K7zeHy?usp=sharing

